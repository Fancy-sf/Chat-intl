
전통적인 판매 방삭은 비용이 많이 들고 효과를 평가하기 어렵습니다. 그러나 라이브 커머스는 검색 채널, 딜리버리 채널, 주문 채널, 평가 채널 및 운영 채널을 통합하여 채널 리디렉션으로 인한 고객 유실을 방지합니다. 따라서 라이브 커머스는 인터넷 시대의 통합 마케팅에 필수적인 부분입니다.
데이터에 따르면, 2019년 중국의 라이브 스트리밍 서비스 사용자 수는 5억 400만 명에 이르렀고 2020년에는 5억 2600만 명에 달할 것으로 예상되며, 판매 규모는 전체 온라인 리테일 규모의 8.7%를 차지하는 9,160억RMB에 달할 것으로 예상됩니다. 라이브 커머스 플랫폼 구축은 시장 효과를 누릴 수 있는 가장 효과적인 방법입니다.
## 배경


인터랙티브 시나리오의 경우 다음 기능을 구현해야 합니다.
- 채팅방
- 공지
- 그룹 입/퇴장 알림
- 백엔드에서의 신상품 알림
- 선물하기 알림
- 백엔드에서의 새로운 선물 알림
- 좋아요&좋아요 알림
- 라이브 방송
- 라이브 룸 상태 컨트롤

라이브 커머스의 핵심 기능은 IM 기능과 라이브 방송 기능으로 구분되는 것을 알 수 있으며, [Instant Messaging](https://intl.cloud.tencent.com/document/product/1047)과 [Cloud Streaming Services](https://intl.cloud.tencent.com/document/product/1047)를 니즈 실현의 기반으로 사용합니다.


## 시나리오 기반 SDK

라이브 커머스 시나리오에서 사용자 정의 메시지를 통해 좋아요, 선물하기, 팔로우 알림을 구현할 수 있으며, 사용자 정의 필드를 통해 신상품 알림, 그룹 상태 변경 알림을 구현할 수 있습니다. 이를 기반으로 라이브 커머스 시나리오의 관련 기능을 쉽게 구현할 수 있도록 [시나리오 기반 SDK](https://www.npmjs.com/package/im-live-sells)를 캡슐화하였습니다. 자세한 사용 방법은 [미니 프로그램 라이브 방송 SDK API](https://intl.cloud.tencent.com/document/product/1047/36211)를 참고하십시오.

다음 절차에 따라 라이브 커머스 플랫폼을 구축할 수 있습니다.

## 작업 절차
### 1단계: IM의 AVChatroom을 사용하여 라이브 채팅방 구현

채팅방은 라이브 방송에서 중요한 부분으로 사용자가 하고 싶은 말을 하거나 채팅방 내 다른 구성원의 메시지를 받을 수 있습니다.

1. [IM 콘솔](https://console.cloud.tencent.com/im)에 로그인하고 [신규 애플리케이션 추가]를 클릭합니다.
2. [애플리케이션 생성] 대화 상자에 애플리케이션 이름을 입력한 후 [확인]을 클릭합니다.
    생성 완료 후, 콘솔 전체보기 페이지에서 새로 생성된 애플리케이션의 상태, 서비스 버전, SDKAppID, 생성 시간 및 만료 시간을 확인할 수 있습니다.
  >? 새로 생성된 애플리케이션은 기본적으로 체험판이며, 필요에 따라 프로 버전 또는 울티메이트 버전으로 [업그레이드](https://intl.cloud.tencent.com/document/product/1047/34577)할 수 있습니다.
  >동일한 Tencent Cloud 계정으로 최대 300개의 IM 애플리케이션을 만들 수 있습니다. 이미 300개의 애플리케이션이 있는 경우 신규 애플리케이션 생성 전에 사용하지 않는 애플리케이션을 [비활성화 및 삭제](https://intl.cloud.tencent.com/document/product/1047/34540)합니다. **애플리케이션 삭제 후에는 SDKAppID에 해당하는 모든 데이터 및 서비스를 복구할 수 없으므로 주의하시기 바랍니다. **


3. 대상 애플리케이션 카드를 클릭하고 왼쪽 사이드바에서 [그룹 관리]를 선택합니다.
4. [그룹 관리] 페이지에서 [그룹 추가]를 클릭합니다.
5. 그룹 추가 팝업 창에서 다음 매개변수를 설정합니다.
 - 그룹 이름: 필수 입력 사항으로 길이는 30바이트를 초과하지 않아야 합니다.
 - 그룹 소유자 ID : 선택 입력 사항으로, 이미 등록된 사용자 이름을 입력해야 합니다.
 - 그룹 유형 : 그룹 유형을 설정합니다. 그룹 관련 자세한 안내는 [그룹 시스템](https://intl.cloud.tencent.com/document/product/1047/33529)을 참고하십시오. **라이브 방송 그룹(AVChatRoom)으로	
설정할 것을 권장합니다**.
3. [확인]을 클릭하여 설정을 저장합니다.
 그룹 생성 후, 그룹 목록에서 그룹 ID, 그룹 이름, 그룹 소유자, 유형, 생성 시간을 확인할 수 있습니다.


### 2단계: 사용자 정의 메시지를 사용하여 좋아요, 선물하기, 구매 등에 대한 메시지 알림을 구현합니다.

라이브 방송 시나리오에서, 활발한 구성원의 참여를 유도하기 위해서는 실시간으로 많은 양의 메시지를 구성원에게 전송해야 합니다. 예를 들어, 그룹 구성원이 호스트에게 선물을 보내면, 모든 그룹 구성원에게 알림을 전송하고 화려한 특수 효과로 표시하는 경우, 모든 그룹 구성원의 선물 관련 알림은 IM 사용자 정의 메시지로 구현할 수 있습니다. 사용자 정의 메시지에는 추가 정보가 포함될 수 있습니다. 예를 들어, 사용자가 선물하기 메시지를 발송할 때, 선물 정보, 사용자 정보등 추가 정보를 수반할 수 있습니다. 좋아요, 상품 구매, 호스트 팔로우와 같은 다른 사용자 행위도 동일한 방식으로 구현될 수 있습니다. 텍스트 메시지 및 리치 텍스트 메시지와 달리, 사용자 정의 메시지는 특별한 신호를 전달하는 특별한 종류의 메시지입니다.

SDK에서의 사용자 정의 메시지 발송 샘플 코드는 다음과 같습니다.

```
public async sendCustomMsgAndEmitEvent(type: string, extension?: string) {
        const message = this.tim.createCustomMessage({
            to: this.roomID,
            conversationType: this.TIM.TYPES.CONV_GROUP,
            priority: this.TIM.TYPES.MSG_PRIORITY_HIGH,
            payload: {
                data: type,
                description: '',
                extension: extension
            }
        })
        await this.tim.sendMessage(message)
        const res = {
            nick: this.userInfo.nick,
            avatar: this.userInfo.avatar,
            value: extension,
            userID:this.userInfo.userID
        }
        this.eventBus.emit(type, res)
        return res
}
```

### 3단계: 그룹 사용자 정의 필드를 사용하여 라이브 룸 신상품 출시, 라이브 방송 상태 변경 알림 구현

라이브 커머스 시나리오에서 호스트가 상품을 추천하면 화면 하단의 상품 구역에 해당 상품을 즉시 업데이트하고, 채팅방 안의 모든 사용자에게 신상품 런칭을 알려야합니다. 신상품 메시지는 어시스턴트에 의해 트리거됩니다.
기술적인 관점에서 보면 어시스턴트가 신상품 메시지를 트리거하는 방법은 두 가지가 있습니다.
- 사용자 정의 메시지 발송
 - 이 방법은 현재 라이브 방송 그룹에 어시스턴트가 추가되어 있어야 합니다.
 -그룹 메시지량이 너무 많을 경우, IM 백엔드는 메시지의 우선 순위에 따라 메시지를 반환합니다. 사용자 정의 메시지의 우선 순위가 낮을 경우, 사용자측에 상품이 즉시 업데이트되지 않을 수 있습니다.
- 그룹 정보 변경
 - 이 방법은 라이브 방송 그룹의 구성원(예: 관리자 역할)이나 구성원이 아닌 사용자 모두 어시스턴트가 될 수 있습니다. 
 - 이미 설정된 기본 그룹 정보 필드가 있지만, IM은 필드 정의 및 읽기/쓰기 권한을 사용자 정의할 수 있는 그룹 레벨의 사용자 정의 필드를 제공합니다. 

따라서 **관리자가 그룹 사용자 정의 필드를 변경하는 방식**을 통한 신상품 알림 구현을 권장합니다. 구체적인 절차는 다음과 같습니다.

#### 그룹 사용자 정의 필드 추가

1. [IM 콘솔](https://console.cloud.tencent.com/im)에 로그인하여 대상 애플리케이션 카드를 클릭하고 왼쪽 사이드바에서 [기능 설정]>[그룹 사용자 정의 필드]를 선택합니다.
2. [그룹 사용자 정의 필드] 페이지에서 [그룹 레벨 사용자 정의 필드 추가]를 클릭합니다.
3. 그룹 레벨 사용자 정의 필드 팝업 창에서 필드 이름을 입력하고 그룹 유형과 읽기 및 쓰기 권한을 설정합니다.
  >?
  - 필드 이름은 문자, 숫자, 언더바(\_)로만 구성할 수 있으며, 숫자로 시작할 수 없고, 길이는 16자를 초과할 수 없습니다.
  - 그룹 사용자 정의 필드 이름은 그룹 구성원 사용자 정의 필드 이름과 같을 수 없습니다.
  >
4. [사용자 정의 필드 및 그룹 유형 추가 후, 추가된 그룹 유형의 읽기 및 쓰기 권한만 수정할 수 있고, 삭제는 불가능함을 알고 있습니다.]를 선택하고, [확인]을 클릭하여 설정을 저장합니다.
 그룹 레벨 사용자 정의 필드 설정은 약 10분 후 적용됩니다.

#### 그룹 사용자 정의 필드 사용

어시스턴트가 그룹 관리자 신분으로 [그룹 기본 정보 수정](https://intl.cloud.tencent.com/document/product/1047/34962) REST API를 호출하여 그룹 사용자 정의 필드를 업데이트하고, 라이브 룸의 신상품 알림 및 라이브 방송 상태 변경 알림을 구현할 수 있습니다.


### 4단계: 그룹 메시지 후 콜백을 사용하여 사용자 수준 통계 실현

라이브 방송 시나리오에서 사용자는 프로필 사진, 닉네임 등 외에도 레벨 정보를 가지고 있습니다. 메시지 발송, 선물하기를 하면 사용자의 레벨이 상승합니다. 콜백을 통해 관련 기능을 구현할 수 있습니다. 콜백을 통해 사용자의 그룹, 관계망, 1:1 채팅, 온라인 상태 등의 상태가 변경될 때 알림을 받을 수 있으며, 그룹 채팅에서 사용자의 텍스트 메시지 발송, 선물하기 등에 근거하여 사용자 레벨을 변경할 수 있습니다. 
콜백 관련 작업은 [콜백 설정](https://intl.cloud.tencent.com/document/product/1047/34520) 및 [서드 파티 콜백 소개](https://intl.cloud.tencent.com/document/product/1047/34354)를 참고하십시오.



### 5단계: CSS를 통한 푸시 주소 생성 및 라이브 방송 시작 
Tencent Cloud LVB는 전자상거래 플랫폼의 발전을 도와, 업체가 상품 정보를 더욱 복합적으로 전달할 수 있게 하고, 사용자의 효과적인 의사 결정을 도와 마케팅 비용 절감과 거래량을 증가시켰습니다.
라이브 방송 시작 전 [주소 생성기](https://intl.cloud.tencent.com/document/product/267/31084)를 통해 푸시 스트림 주소를 생성한 후, [라이브 방송 푸시 스트림](https://intl.cloud.tencent.com/document/product/267/31558)을 진행합니다.

